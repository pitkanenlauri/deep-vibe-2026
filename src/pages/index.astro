---
import '../styles/global.css';
import profileData from '../data/profile.json';
import Header from '../components/layout/Header.astro';
import Section from '../components/layout/Section.astro';
import MetaFooter from '../components/layout/MetaFooter.astro';
import Timeline from '../components/experience/Timeline.astro';
import Education from '../components/education/Education.astro';
import Hero from '../components/hero/Hero.astro';
import {
	HighlightReveal,
	CardGrid,
	CardItem
} from '../components/animations/AnimatedSection';
import SkillsChart from '../components/skills/SkillsChart';
import KonamiCode from '../components/easter-eggs/KonamiCode';
import SpaceBackground from '../components/background/SpaceBackground';

const { hero, highlight, experience, philosophy, skills, education, meta } = profileData;
---

<html lang="en" data-theme="dark">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="generator" content={Astro.generator} />
		<title>{hero.name} | {hero.headline}</title>
		<meta name="description" content={hero.tagline} />

		<!-- Theme initialization script (runs before render to prevent flash) -->
		<script is:inline>
			(function() {
				const theme = localStorage.getItem('theme') || 'dark';
				document.documentElement.setAttribute('data-theme', theme);
			})();
		</script>

		<!-- Preconnect to Google Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
			rel="stylesheet"
		/>
	</head>
	<body class="min-h-screen bg-gray-50 text-gray-800 transition-colors duration-300">
		<!-- Space Background (dark mode only) -->
		<SpaceBackground client:load />

		<Header name={hero.name} />

		<main class="max-w-4xl mx-auto px-4">
			<!-- Hero Section -->
			<Section id="hero" class="pt-8 md:pt-12 !pb-2">
				<Hero
					name={hero.name}
					headline={hero.headline}
					tagline={hero.tagline}
					location={hero.location}
					impactStats={hero.impactStats}
					ctaLinks={hero.ctaLinks}
				/>
			</Section>

			<!-- Highlight Section -->
			<Section id="highlight" variant="highlight" class="accent-bar pl-6 !py-4 !md:py-5">
				<HighlightReveal client:visible>
					<div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4">
						<div>
							<h2 class="text-title gradient-text-vibrant">{highlight.title}</h2>
							<p class="text-small text-muted mt-1">
								<span class="tag-primary mr-2">{highlight.category}</span>
								{highlight.context}
							</p>
						</div>
					</div>
					<p class="text-body mt-4 text-gray-700">{highlight.description}</p>
				</HighlightReveal>
			</Section>

			<!-- Experience Section -->
			<Section id="experience" title="Experience" variant="accent">
				<Timeline experiences={experience} />
			</Section>

			<!-- Philosophy Section -->
			<Section id="philosophy" title="Philosophy" variant="gradient">
				<CardGrid client:visible className="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
					{philosophy.map((item) => (
						<CardItem client:visible>
							<article class="p-6 bg-white rounded-lg border border-gray-200 h-full">
								<h3 class="text-title text-gray-900">{item.title}</h3>
								<p class="text-body text-gray-700 mt-3">{item.belief}</p>
								{item.source && (
									<p class="text-small text-muted mt-4 italic">
										â€” {item.source.author}, {item.source.work}
									</p>
								)}
							</article>
						</CardItem>
					))}
				</CardGrid>
			</Section>

			<!-- Skills Section -->
			<Section id="skills" title="Skills">
				<SkillsChart client:visible skills={skills} />
			</Section>

			<!-- Education Section -->
			<Section id="education" title="Education">
				<Education education={education} />
			</Section>
		</main>

		<!-- Meta Footer: The "How This Was Built" Story -->
		<MetaFooter />

		<!-- Easter Egg: Konami Code -->
		<KonamiCode
			client:idle
			agents={meta.agents}
			buildTimestamp={meta.buildTimestamp}
			bundleSize={meta.bundleSize}
			sourceUrl={meta.sourceUrl}
		/>
	</body>
</html>
