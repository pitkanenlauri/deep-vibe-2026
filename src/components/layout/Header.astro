---
interface NavItem {
  label: string;
  href: string;
}

interface Props {
  name: string;
  navItems?: NavItem[];
}

const { name, navItems = [] } = Astro.props;

const defaultNavItems: NavItem[] = [
  { label: 'Experience', href: '#experience' },
  { label: 'Philosophy', href: '#philosophy' },
  { label: 'Skills', href: '#skills' },
];

const navigation = navItems.length > 0 ? navItems : defaultNavItems;
---

<header
  class="sticky top-0 z-50 bg-gray-50/95 backdrop-blur-sm border-b border-gray-200/50 transition-shadow duration-normal"
  data-header
>
  <nav class="max-w-4xl mx-auto px-4 h-14 flex items-center justify-between">
    <a
      href="#hero"
      class="header-logo text-body font-semibold text-gray-900"
    >
      {name}
    </a>

    <ul class="hidden sm:flex items-center gap-6">
      {navigation.map((item) => (
        <li>
          <a
            href={item.href}
            class="header-nav-link text-small text-gray-600"
          >
            {item.label}
          </a>
        </li>
      ))}
    </ul>

    <!-- Mobile menu button -->
    <button
      type="button"
      class="sm:hidden p-2 -mr-2 text-gray-600 hover:text-gray-900 transition-colors duration-fast"
      aria-label="Toggle navigation menu"
      aria-expanded="false"
      data-mobile-menu-toggle
    >
      <svg
        class="w-5 h-5"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"
          data-menu-icon-open
        />
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"
          data-menu-icon-close
          class="hidden"
        />
      </svg>
    </button>
  </nav>

  <!-- Mobile navigation menu -->
  <div
    class="sm:hidden hidden border-t border-gray-200/50 bg-gray-50/95 backdrop-blur-sm"
    data-mobile-menu
  >
    <ul class="px-4 py-3 space-y-1">
      {navigation.map((item) => (
        <li>
          <a
            href={item.href}
            class="mobile-nav-link block py-2 text-body text-gray-600"
            data-mobile-nav-link
          >
            {item.label}
          </a>
        </li>
      ))}
    </ul>
  </div>
</header>

<script>
  // Mobile menu toggle
  const menuToggle = document.querySelector('[data-mobile-menu-toggle]');
  const mobileMenu = document.querySelector('[data-mobile-menu]');
  const iconOpen = document.querySelector('[data-menu-icon-open]');
  const iconClose = document.querySelector('[data-menu-icon-close]');
  const mobileNavLinks = document.querySelectorAll('[data-mobile-nav-link]');

  function toggleMenu() {
    const isExpanded = menuToggle?.getAttribute('aria-expanded') === 'true';
    menuToggle?.setAttribute('aria-expanded', String(!isExpanded));
    mobileMenu?.classList.toggle('hidden');
    iconOpen?.classList.toggle('hidden');
    iconClose?.classList.toggle('hidden');
  }

  function closeMenu() {
    menuToggle?.setAttribute('aria-expanded', 'false');
    mobileMenu?.classList.add('hidden');
    iconOpen?.classList.remove('hidden');
    iconClose?.classList.add('hidden');
  }

  menuToggle?.addEventListener('click', toggleMenu);

  // Close menu when clicking a nav link
  mobileNavLinks.forEach((link) => {
    link.addEventListener('click', closeMenu);
  });

  // Add shadow to header on scroll
  const header = document.querySelector('[data-header]');

  function updateHeaderShadow() {
    if (window.scrollY > 10) {
      header?.classList.add('shadow-sm');
    } else {
      header?.classList.remove('shadow-sm');
    }
  }

  window.addEventListener('scroll', updateHeaderShadow, { passive: true });
  updateHeaderShadow();
</script>
